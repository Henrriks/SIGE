{% extends 'core/base.html' %}
{% load static %}

{% block title %}Painel do Superusuário{% endblock %}
{% block header_title %}Painel do Superusuário{% endblock %}

{% block user_info %}
  <span>Olá, <a href="{% url 'editar_perfil_super' %}" title="Editar Perfil">{{ request.user.get_full_name|default:request.user.username }}</a></span>
  <a href="{% url 'editar_perfil_super' %}" title="Editar Perfil"><i class="fas fa-user"></i></a>
  <a href="{% url 'painel_super' %}" title="Voltar ao Painel"><i class="fas fa-arrow-left"></i></a>
  <a href="{% url 'logout' %}" title="Sair"><i class="fas fa-power-off"></i></a>
{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="{% static 'core/css/lista_discentes.css' %}">
{% endblock %}

{% block content %}
<div class="container">

  <!-- Topo com botão e busca -->
  <div class="top-controls">
    <a href="{% url 'cadastrar_disciplina' %}">
      <button class="cadastrar-btn">
        <i class="fas fa-book"></i>
        Cadastrar Disciplina
      </button>
    </a>

    <form class="buscar-form-container" method="get" action="{% url 'listar_disciplinas' %}">
      <input type="text" class="buscar-input" name="q" placeholder="Buscar turma..." value="{{ query|default:'' }}">
      <button type="submit" class="buscar-btn">
        <i class="fas fa-search"></i>
      </button>
    </form>
  </div>

  <!-- Conteúdo por turma -->
  <div class="content-box">
    <h2 class="titulo">DISCIPLINAS POR TURMA</h2>

    {% for turma in turmas %}
      <h3 style="text-align: center; margin-top: 30px; color: #fff;">{{ turma.nome }}</h3>

      {% if turma.disciplina_set.all %}
        <table class="tabela-discentes">
          <thead>
            <tr class="tabela-principal">
              <th class="tabela-cabecalho">DISCIPLINA</th>
              <th class="tabela-cabecalho">DOCENTE</th>
              <th class="tabela-cabecalho">AÇÕES</th>
            </tr>
          </thead>
          <tbody>
            {% for disciplina in turma.disciplina_set.all %}
              <tr class="linhas-tabela">
                <td class="tabela-info">{{ disciplina.nome }}</td>
                <td class="tabela-info">{{ disciplina.professor.user.get_full_name }}</td>
                <td class="tabela-icones">
                  <a href="{% url 'editar_disciplina' disciplina.id %}" class="action-btn editar" title="Editar">
                    <i class="fas fa-pen-to-square"></i>
                  </a>
                  <a href="{% url 'excluir_disciplina' disciplina.id %}" class="action-btn deletar" title="Excluir" onclick="return confirm('Deseja excluir esta disciplina?')">
                    <i class="fas fa-trash-can"></i>
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p style="color: #fff; text-align: center;"><em>Nenhuma disciplina cadastrada nesta turma.</em></p>
      {% endif %}
    {% endfor %}
  </div>

</div>
{% endblock %}
